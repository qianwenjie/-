# AIåŠ©æ‰‹æ™ºèƒ½åŒ–å‡çº§è®¾è®¡æ–¹æ¡ˆ

> **è®¾è®¡æ—¥æœŸ**: 2026-02-02  
> **è®¾è®¡ç›®æ ‡**: å°†è€ƒè¯•ç³»ç»ŸAIåŠ©æ‰‹ä»æœºæ¢°å¼å¯¹è¯å‡çº§ä¸ºæ™ºèƒ½åŒ–ã€è‡ªé€‚åº”çš„è‡ªç„¶è¯­è¨€äº¤äº’ç³»ç»Ÿ  
> **å®æ–½æ–¹å¼**: æ¸è¿›å¼å¢å¼ºï¼ˆ4é˜¶æ®µï¼Œ5-6å‘¨ï¼‰

---

## ğŸ“‹ è®¾è®¡èƒŒæ™¯

### å½“å‰é—®é¢˜
- **è¯†åˆ«èƒ½åŠ›å¼±**: æ— æ³•ç†è§£"æ‰€æœ‰é¢˜å‹"ã€"æ¥ç‚¹å•é€‰"ç­‰è‡ªç„¶è¡¨è¾¾
- **äº¤äº’åƒµç¡¬**: æœºæ¢°å¼æ­¥éª¤å¼•å¯¼ï¼Œç¼ºä¹çµæ´»æ€§
- **æ— è®°å¿†èƒ½åŠ›**: ä¸è®°å½•ç”¨æˆ·ä¹ æƒ¯ï¼Œæ¯æ¬¡éƒ½è¦é‡å¤è¾“å…¥
- **æ— æ™ºèƒ½æ¨è**: ä¸èƒ½æ ¹æ®å†å²è¡Œä¸ºæä¾›å»ºè®®

### è®¾è®¡ç›®æ ‡
- **è‡ªç„¶è¯­è¨€ç†è§£**: æ”¯æŒåŒä¹‰è¯ã€å£è¯­åŒ–ã€éšå«æ„å›¾è¯†åˆ«
- **ä¸Šä¸‹æ–‡æ„ŸçŸ¥**: è®°ä½å¯¹è¯å†å²å’Œç”¨æˆ·åå¥½
- **æ™ºèƒ½æ¨è**: åŸºäºè¡Œä¸ºåˆ†ææä¾›ä¸ªæ€§åŒ–å»ºè®®
- **è‡ªé€‚åº”äº¤äº’**: æ–°ç”¨æˆ·è¯¦ç»†å¼•å¯¼ï¼Œè€ç”¨æˆ·å¿«é€Ÿæ‰§è¡Œ
- **é€æ˜å¯æ§**: æ˜¾ç¤ºAIç†è§£ç½®ä¿¡åº¦ï¼Œç”¨æˆ·å¯éšæ—¶ä¿®æ­£

---

## ğŸ—ï¸ æ•´ä½“æ¶æ„

### ä¸‰å±‚æ¶æ„è®¾è®¡

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     ç”¨æˆ·ç•Œé¢å±‚ (UI Layer)            â”‚
â”‚  - å¯¹è¯è¾“å…¥æ¡†                        â”‚
â”‚  - æ¶ˆæ¯æ˜¾ç¤ºåŒº                        â”‚
â”‚  - ç½®ä¿¡åº¦å¯è§†åŒ–ç»„ä»¶                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   å¯¹è¯ç®¡ç†å±‚ (Conversation Manager)  â”‚
â”‚  - ç°æœ‰çš„ConversationManagerç±»       â”‚
â”‚  - æ¶ˆæ¯å†å²ç®¡ç†                      â”‚
â”‚  - æ­¥éª¤æµç¨‹æ§åˆ¶                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   æ™ºèƒ½å¢å¼ºå±‚ (Intelligence Layer)    â”‚ â† æ–°å¢
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚ 1. NLPç†è§£å¼•æ“                   â”‚â”‚
â”‚  â”‚    - SmartParamExtractor         â”‚â”‚
â”‚  â”‚    - åŒä¹‰è¯è¯†åˆ«                  â”‚â”‚
â”‚  â”‚    - å£è¯­åŒ–ç†è§£                  â”‚â”‚
â”‚  â”‚    - ç½®ä¿¡åº¦è®¡ç®—                  â”‚â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤â”‚
â”‚  â”‚ 2. ç”¨æˆ·åå¥½ç®¡ç†                  â”‚â”‚
â”‚  â”‚    - UserPreferenceManager       â”‚â”‚
â”‚  â”‚    - è¡Œä¸ºè®°å½•                    â”‚â”‚
â”‚  â”‚    - æ¨¡å¼åˆ†æ                    â”‚â”‚
â”‚  â”‚    - åå¥½ç»Ÿè®¡                    â”‚â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤â”‚
â”‚  â”‚ 3. æ™ºèƒ½æ¨èå¼•æ“                  â”‚â”‚
â”‚  â”‚    - SmartRecommendationEngine   â”‚â”‚
â”‚  â”‚    - å‚æ•°æ¨è                    â”‚â”‚
â”‚  â”‚    - å»ºè®®ç”Ÿæˆ                    â”‚â”‚
â”‚  â”‚    - ç½®ä¿¡åº¦è¯„ä¼°                  â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### è®¾è®¡åŸåˆ™
- **æ¸è¿›å¼å¢å¼º**: åœ¨ç°æœ‰ç³»ç»ŸåŸºç¡€ä¸Šé€æ­¥æ·»åŠ æ™ºèƒ½åŠŸèƒ½
- **å‘åå…¼å®¹**: ä¿ç•™æ‰€æœ‰ç°æœ‰APIæ¥å£ï¼ŒåŸæœ‰åŠŸèƒ½ä¸å—å½±å“
- **å¯ç‹¬ç«‹å¼€å…³**: æ™ºèƒ½åŠŸèƒ½å¯ç‹¬ç«‹å¯ç”¨/ç¦ç”¨
- **æ•°æ®é©±åŠ¨**: åŸºäºç”¨æˆ·å®é™…è¡Œä¸ºæ•°æ®è¿›è¡Œä¼˜åŒ–

---

## ğŸ§  Part 1: NLPå¢å¼ºå±‚

### SmartParamExtractor ç±»è®¾è®¡

#### æ ¸å¿ƒåŠŸèƒ½
```javascript
class SmartParamExtractor {
  // åŒä¹‰è¯è¯å…¸
  synonyms = {
    type: {
      'å•é€‰': ['å•é€‰é¢˜', 'é€‰æ‹©é¢˜', 'å•é¡¹é€‰æ‹©', 'å•é€‰é¢˜ç›®'],
      'å¤šé€‰': ['å¤šé€‰é¢˜', 'å¤šé¡¹é€‰æ‹©', 'å¤šé€‰é¢˜ç›®'],
      'åˆ¤æ–­': ['åˆ¤æ–­é¢˜', 'å¯¹é”™é¢˜', 'æ˜¯éé¢˜'],
      'å¡«ç©º': ['å¡«ç©ºé¢˜', 'å¡«å†™é¢˜'],
      'ç®€ç­”': ['ç®€ç­”é¢˜', 'é—®ç­”é¢˜', 'ä¸»è§‚é¢˜'],
      'æ‰€æœ‰': ['å…¨éƒ¨', 'æ‰€æœ‰é¢˜å‹', 'å…¨éƒ¨é¢˜å‹', 'æ··åˆ', 'éšæœºé¢˜å‹', 'å„ç§é¢˜å‹']
    },
    difficulty: {
      'ç®€å•': ['å®¹æ˜“', 'åŸºç¡€', 'å…¥é—¨', 'åˆçº§', 'ä¸€çº§'],
      'ä¸­ç­‰': ['ä¸­çº§', 'æ™®é€š', 'äºŒçº§'],
      'å›°éš¾': ['éš¾', 'é«˜çº§', 'ä¸‰çº§'],
      'å¾ˆéš¾': ['è¶…éš¾', 'å››çº§'],
      'æéš¾': ['æœ€éš¾', 'äº”çº§']
    },
    quantity: {
      'å¤š': ['å¤šç‚¹', 'å¤šæ¥ç‚¹', 'å¤šä¸€äº›', 'å¤šå‡ é“'],
      'å°‘': ['å°‘ç‚¹', 'å°‘æ¥ç‚¹', 'å‡ é“', 'å°‘ä¸€äº›']
    }
  }
  
  // å£è¯­åŒ–æ¨¡å¼è¯†åˆ«
  patterns = {
    'æ¥ç‚¹': { action: 'generate', quantity: 'default' },
    'éšä¾¿': { confidence: 'low', needConfirm: true },
    'å’Œä¸Šæ¬¡ä¸€æ ·': { useHistory: true },
    'æŒ‰ä¹ æƒ¯æ¥': { usePreference: true },
    'ä¸è¦': { negation: true },
    'æ”¹æˆ': { correction: true },
    'æ¯”...æ›´': { comparison: true }
  }
  
  // æå–å‚æ•°å¹¶è¿”å›ç½®ä¿¡åº¦
  extract(input, context) {
    const params = {};
    const confidence = {};
    const ambiguous = [];
    
    // 1. é¢˜å‹è¯†åˆ«
    const typeResult = this.extractType(input);
    if (typeResult) {
      params.type = typeResult.value;
      params.typeName = typeResult.name;
      confidence.type = typeResult.confidence;
    }
    
    // 2. æ•°é‡è¯†åˆ«
    const countResult = this.extractCount(input);
    if (countResult) {
      params.count = countResult.value;
      confidence.count = countResult.confidence;
    }
    
    // 3. éš¾åº¦è¯†åˆ«
    const diffResult = this.extractDifficulty(input);
    if (diffResult) {
      params.difficulty = diffResult.value;
      params.difficultyName = diffResult.name;
      confidence.difficulty = diffResult.confidence;
    }
    
    // 4. çŸ¥è¯†ç‚¹è¯†åˆ«
    const kpResult = this.extractKnowledgePoint(input);
    if (kpResult) {
      params.knowledgePoint = kpResult.value;
      confidence.knowledgePoint = kpResult.confidence;
    }
    
    // 5. ç‰¹æ®Šæ¨¡å¼è¯†åˆ«
    const patternResult = this.matchPatterns(input);
    if (patternResult) {
      Object.assign(params, patternResult.params);
      ambiguous.push(...patternResult.ambiguous);
    }
    
    return { params, confidence, ambiguous };
  }
}
```

#### ç½®ä¿¡åº¦è®¡ç®—è§„åˆ™
- **é«˜ç½®ä¿¡åº¦ (0.8-1.0)**: ç²¾ç¡®åŒ¹é…ã€æ˜ç¡®è¡¨è¾¾
  - ç¤ºä¾‹: "10é“å•é€‰é¢˜" â†’ type: 1.0, count: 1.0
- **ä¸­ç½®ä¿¡åº¦ (0.5-0.8)**: åŒä¹‰è¯åŒ¹é…ã€æ¨æ–­å¾—å‡º
  - ç¤ºä¾‹: "æ¥ç‚¹é€‰æ‹©é¢˜" â†’ type: 0.7, count: 0.6
- **ä½ç½®ä¿¡åº¦ (0-0.5)**: æ¨¡ç³Šè¡¨è¾¾ã€éœ€è¦ç¡®è®¤
  - ç¤ºä¾‹: "éšä¾¿æ¥ç‚¹" â†’ type: 0.3, count: 0.4

---

## ğŸ‘¤ Part 2: ç”¨æˆ·åå¥½ç®¡ç†ç³»ç»Ÿ

### UserPreferenceManager ç±»è®¾è®¡

#### æ•°æ®ç»“æ„
```javascript
{
  userId: 'user_001',
  
  // 1. åŸºç¡€åå¥½ç»Ÿè®¡
  basicPreferences: {
    questionType: {
      'single': { count: 45, percentage: 0.45 },
      'multiple': { count: 30, percentage: 0.30 },
      'judge': { count: 15, percentage: 0.15 },
      'fill': { count: 10, percentage: 0.10 }
    },
    difficulty: {
      '1': { count: 20, percentage: 0.20 },
      '2': { count: 60, percentage: 0.60 },
      '3': { count: 20, percentage: 0.20 }
    },
    quantity: {
      average: 10,
      range: [5, 20],
      mostCommon: 10,
      distribution: {
        '5': 15,
        '10': 50,
        '15': 20,
        '20': 15
      }
    }
  },
  
  // 2. åœºæ™¯åå¥½
  scenarioPreferences: {
    'generate_questions': {
      lastUsed: '2026-02-02 15:30:00',
      frequency: 25,
      commonConfig: {
        type: 'single',
        count: 10,
        difficulty: 2
      }
    },
    'create_exam': {
      lastUsed: '2026-02-01 10:00:00',
      frequency: 5,
      commonConfig: {
        totalScore: 100,
        duration: 90
      }
    }
  },
  
  // 3. è¡Œä¸ºæ¨¡å¼
  behaviorPatterns: {
    timePatterns: {
      weekday: {
        difficulty: 2,
        type: 'single',
        quantity: 10
      },
      weekend: {
        difficulty: 3,
        type: 'composite',
        quantity: 5
      }
    },
    knowledgePointFocus: {
      recent: ['æ•°æ®ç»“æ„', 'ç®—æ³•', 'æ“ä½œç³»ç»Ÿ'],
      trending: 'æ•°æ®ç»“æ„',
      distribution: {
        'æ•°æ®ç»“æ„': 40,
        'ç®—æ³•': 30,
        'æ“ä½œç³»ç»Ÿ': 20,
        'å…¶ä»–': 10
      }
    },
    commonCombinations: [
      { type: 'single', difficulty: 2, count: 10, frequency: 30 },
      { type: 'multiple', difficulty: 2, count: 5, frequency: 15 }
    ]
  },
  
  // 4. å¯¹è¯é£æ ¼åå¥½
  conversationStyle: {
    verbosity: 'concise',        // ç®€æ´ | è¯¦ç»†
    confirmationNeeded: false,   // æ˜¯å¦éœ€è¦ç¡®è®¤
    preferQuickActions: true,    // åå¥½å¿«é€Ÿæ“ä½œ
    feedbackFrequency: 'low'     // åé¦ˆé¢‘ç‡
  },
  
  // 5. å…ƒæ•°æ®
  metadata: {
    totalActions: 100,
    firstActionDate: '2026-01-01',
    lastActionDate: '2026-02-02',
    experienceLevel: 'expert'    // novice | intermediate | expert
  }
}
```

#### æ›´æ–°ç­–ç•¥
- **æ»‘åŠ¨çª—å£**: åªä¿ç•™æœ€è¿‘30å¤©çš„æ•°æ®
- **æƒé‡è¡°å‡**: è¶Šè¿‘æœŸçš„æ“ä½œæƒé‡è¶Šé«˜
- **å¼‚å¸¸è¿‡æ»¤**: è¿‡æ»¤æ˜æ˜¾çš„è¯¯æ“ä½œæ•°æ®

---

## ğŸ¯ Part 3: æ™ºèƒ½æ¨èå¼•æ“

### SmartRecommendationEngine ç±»è®¾è®¡

#### æ ¸å¿ƒé€»è¾‘
```javascript
class SmartRecommendationEngine {
  constructor(extractor, preferenceManager) {
    this.extractor = extractor;
    this.preferenceManager = preferenceManager;
  }
  
  // ç”Ÿæˆæ¨è
  generateRecommendation(userInput, context) {
    // 1. æå–ç”¨æˆ·è¾“å…¥çš„å‚æ•°
    const extracted = this.extractor.extract(userInput, context);
    
    // 2. è·å–æ¨èå‚æ•°
    const recommended = this.getRecommendedParams(extracted);
    
    // 3. åˆå¹¶å‚æ•°ï¼ˆç”¨æˆ·è¾“å…¥ä¼˜å…ˆï¼‰
    const merged = this.mergeParams(extracted.params, recommended);
    
    // 4. ç”Ÿæˆå»ºè®®æ–‡æœ¬
    const suggestion = this.formatSuggestion(merged, extracted);
    
    return {
      params: merged,
      confidence: extracted.confidence,
      suggestion: suggestion
    };
  }
  
  // è·å–æ¨èå‚æ•°
  getRecommendedParams(extracted) {
    const prefs = this.preferenceManager.getPreferences();
    const recommended = {};
    
    // é¢˜å‹æ¨è
    if (!extracted.params.type || extracted.confidence.type < 0.8) {
      recommended.type = prefs.basicPreferences.questionType.mostCommon;
    }
    
    // æ•°é‡æ¨è
    if (!extracted.params.count || extracted.confidence.count < 0.8) {
      recommended.count = prefs.basicPreferences.quantity.average;
    }
    
    // éš¾åº¦æ¨è
    if (!extracted.params.difficulty) {
      recommended.difficulty = prefs.basicPreferences.difficulty.mostCommon;
    }
    
    return recommended;
  }
  
  // å‚æ•°åˆå¹¶ï¼ˆç”¨æˆ·è¾“å…¥ä¼˜å…ˆï¼‰
  mergeParams(userParams, recommendedParams) {
    return {
      ...recommendedParams,
      ...userParams  // ç”¨æˆ·è¾“å…¥è¦†ç›–æ¨è
    };
  }
  
  // æ ¼å¼åŒ–å»ºè®®
  formatSuggestion(params, extracted) {
    const parts = [];
    
    // é¢˜å‹
    if (extracted.confidence.type > 0.8) {
      parts.push(`âœ… é¢˜å‹ï¼š${params.typeName}ï¼ˆç¡®å®šï¼‰`);
    } else if (params.type) {
      parts.push(`âš ï¸ é¢˜å‹ï¼š${params.typeName}ï¼ˆæ ¹æ®æ‚¨çš„ä¹ æƒ¯æ¨èï¼‰`);
    } else {
      parts.push(`â“ é¢˜å‹ï¼šæœªæŒ‡å®š`);
    }
    
    // æ•°é‡
    if (extracted.confidence.count > 0.8) {
      parts.push(`âœ… æ•°é‡ï¼š${params.count}é“ï¼ˆç¡®å®šï¼‰`);
    } else if (params.count) {
      parts.push(`âš ï¸ æ•°é‡ï¼š${params.count}é“ï¼ˆæ ¹æ®æ‚¨çš„ä¹ æƒ¯æ¨èï¼‰`);
    } else {
      parts.push(`â“ æ•°é‡ï¼šæœªæŒ‡å®š`);
    }
    
    // éš¾åº¦
    if (params.difficulty) {
      if (extracted.confidence.difficulty > 0.8) {
        parts.push(`âœ… éš¾åº¦ï¼š${params.difficultyName}ï¼ˆç¡®å®šï¼‰`);
      } else {
        parts.push(`âš ï¸ éš¾åº¦ï¼š${params.difficultyName}ï¼ˆæ ¹æ®æ‚¨çš„ä¹ æƒ¯æ¨èï¼‰`);
      }
    }
    
    return `æˆ‘çš„ç†è§£æ˜¯ï¼š\n${parts.join('\n')}\n\nè¦æŒ‰è¿™ä¸ªç”Ÿæˆå—ï¼Ÿï¼ˆå›å¤"ç¡®è®¤"æˆ–"ä¿®æ”¹XXä¸ºYY"ï¼‰`;
  }
}
```

#### æ¨èæ—¶æœº
1. **è¾“å…¥ä¸å®Œæ•´**: ç”¨æˆ·åªæä¾›éƒ¨åˆ†å‚æ•°æ—¶
2. **æ˜ç¡®è¯·æ±‚**: ç”¨æˆ·è¯´"æŒ‰ä¹ æƒ¯æ¥"ã€"å’Œä¸Šæ¬¡ä¸€æ ·"
3. **æ–°ç”¨æˆ·**: ä½¿ç”¨æ¬¡æ•°<5æ¬¡æ—¶ï¼Œæä¾›é€šç”¨é»˜è®¤å€¼

---

## ğŸ“Š Part 4: ç½®ä¿¡åº¦æ˜¾ç¤ºå®ç°

### ConfidenceIndicator ç»„ä»¶è®¾è®¡

#### ç½®ä¿¡åº¦ç­‰çº§
```javascript
class ConfidenceIndicator {
  levels = {
    high: { 
      icon: 'âœ…', 
      color: 'text-green-600', 
      label: 'ç¡®å®š',
      description: 'AIç¡®å®šç†è§£äº†æ‚¨çš„æ„å›¾'
    },
    medium: { 
      icon: 'âš ï¸', 
      color: 'text-yellow-600', 
      label: 'æ¨è',
      description: 'åŸºäºæ‚¨çš„ä½¿ç”¨ä¹ æƒ¯æ¨è'
    },
    low: { 
      icon: 'â“', 
      color: 'text-gray-500', 
      label: 'æœªæŒ‡å®š',
      description: 'éœ€è¦æ‚¨è¡¥å……æˆ–ç¡®è®¤'
    }
  }
  
  // è·å–ç½®ä¿¡åº¦ç­‰çº§
  getLevel(confidence) {
    if (confidence >= 0.8) return this.levels.high;
    if (confidence >= 0.5) return this.levels.medium;
    return this.levels.low;
  }
  
  // æ¸²æŸ“ç½®ä¿¡åº¦æ¶ˆæ¯
  renderConfidenceMessage(params, confidence) {
    const parts = [];
    
    // é¢˜å‹
    const typeLevel = this.getLevel(confidence.type || 0);
    parts.push(`${typeLevel.icon} é¢˜å‹ï¼š${params.typeName || 'æœªæŒ‡å®š'} (${typeLevel.label})`);
    
    // æ•°é‡
    const countLevel = this.getLevel(confidence.count || 0);
    parts.push(`${countLevel.icon} æ•°é‡ï¼š${params.count || 'æœªæŒ‡å®š'}é“ (${countLevel.label})`);
    
    // éš¾åº¦ï¼ˆå¯é€‰ï¼‰
    if (params.difficulty) {
      const diffLevel = this.getLevel(confidence.difficulty || 0);
      parts.push(`${diffLevel.icon} éš¾åº¦ï¼š${params.difficultyName} (${diffLevel.label})`);
    }
    
    // çŸ¥è¯†ç‚¹ï¼ˆå¯é€‰ï¼‰
    if (params.knowledgePoint) {
      const kpLevel = this.getLevel(confidence.knowledgePoint || 0);
      parts.push(`${kpLevel.icon} çŸ¥è¯†ç‚¹ï¼š${params.knowledgePoint} (${kpLevel.label})`);
    }
    
    return `æˆ‘çš„ç†è§£æ˜¯ï¼š\n${parts.join('\n')}\n\n${this.getActionPrompt(confidence)}`;
  }
  
  // æ ¹æ®ç½®ä¿¡åº¦ç”Ÿæˆæ“ä½œæç¤º
  getActionPrompt(confidence) {
    const values = Object.values(confidence);
    const avgConfidence = values.reduce((a, b) => a + b, 0) / values.length;
    
    if (avgConfidence > 0.8) {
      return 'è¦æŒ‰è¿™ä¸ªç”Ÿæˆå—ï¼Ÿï¼ˆå›å¤"ç¡®è®¤"æˆ–"ä¿®æ”¹"ï¼‰';
    } else if (avgConfidence > 0.5) {
      return 'è¿™æ˜¯æ ¹æ®æ‚¨çš„ä¹ æƒ¯æ¨èçš„ï¼Œéœ€è¦è°ƒæ•´å—ï¼Ÿ';
    } else {
      return 'æˆ‘ä¸å¤ªç¡®å®šï¼Œè¯·ç¡®è®¤æˆ–è¡¥å……ä¿¡æ¯ã€‚';
    }
  }
}
```

#### è§†è§‰è®¾è®¡
- **é«˜ç½®ä¿¡åº¦ï¼ˆâœ…ï¼‰**: ç»¿è‰²å›¾æ ‡ï¼Œè¡¨ç¤ºAIç¡®å®šç†è§£
- **ä¸­ç½®ä¿¡åº¦ï¼ˆâš ï¸ï¼‰**: é»„è‰²å›¾æ ‡ï¼Œè¡¨ç¤ºåŸºäºæ¨è
- **ä½ç½®ä¿¡åº¦ï¼ˆâ“ï¼‰**: ç°è‰²å›¾æ ‡ï¼Œè¡¨ç¤ºéœ€è¦ç¡®è®¤

#### äº¤äº’æµç¨‹
1. ç”¨æˆ·è¾“å…¥ â†’ AIæ˜¾ç¤ºç†è§£å’Œç½®ä¿¡åº¦
2. ç”¨æˆ·å¯ä»¥ç›´æ¥ç¡®è®¤æˆ–ä¿®æ”¹ç‰¹å®šå‚æ•°
3. æ”¯æŒ"ä¿®æ”¹é¢˜å‹ä¸ºå¤šé€‰"è¿™æ ·çš„å±€éƒ¨è°ƒæ•´
4. æ”¯æŒ"å…¨éƒ¨é‡æ¥"é‡ç½®æ‰€æœ‰å‚æ•°

---

## ğŸ”— Part 5: é›†æˆç­–ç•¥

### ä¸ç°æœ‰ç³»ç»Ÿçš„é›†æˆ

#### ConversationManagerå¢å¼º
```javascript
class ConversationManager {
  constructor(task) {
    this.task = task;
    
    // æ–°å¢ï¼šæ™ºèƒ½ç»„ä»¶
    this.smartExtractor = new SmartParamExtractor();
    this.preferenceManager = new UserPreferenceManager();
    this.recommendationEngine = new SmartRecommendationEngine(
      this.smartExtractor, 
      this.preferenceManager
    );
    this.confidenceIndicator = new ConfidenceIndicator();
  }
  
  // å¢å¼ºç°æœ‰çš„handleGenerateQuestionsæ–¹æ³•
  handleGenerateQuestions(input) {
    // 1. æ™ºèƒ½æå–å‚æ•°ï¼ˆæ›¿ä»£åŸæœ‰çš„extractQuestionParamsï¼‰
    const result = this.recommendationEngine.generateRecommendation(
      input, 
      this.getContext()
    );
    
    // 2. æ˜¾ç¤ºç½®ä¿¡åº¦åé¦ˆ
    if (this.needsConfirmation(result.confidence)) {
      return this.confidenceIndicator.renderConfidenceMessage(
        result.params, 
        result.confidence
      );
    }
    
    // 3. æ‰§è¡Œç”Ÿæˆï¼ˆåŸæœ‰é€»è¾‘ï¼‰
    const generated = this.generateQuestionsNow(result.params);
    
    // 4. æ›´æ–°ç”¨æˆ·åå¥½
    this.preferenceManager.recordAction('generate_questions', result.params);
    
    return generated;
  }
  
  // è·å–å¯¹è¯ä¸Šä¸‹æ–‡
  getContext() {
    return {
      history: this.task.messages || [],
      lastParams: this.task.generateParams || {},
      timestamp: new Date(),
      scenario: 'generate_questions'
    };
  }
  
  // åˆ¤æ–­æ˜¯å¦éœ€è¦ç¡®è®¤
  needsConfirmation(confidence) {
    const values = Object.values(confidence);
    const avgConfidence = values.reduce((a, b) => a + b, 0) / values.length;
    return avgConfidence < 0.8;  // å¹³å‡ç½®ä¿¡åº¦ä½äº0.8æ—¶éœ€è¦ç¡®è®¤
  }
}
```

#### å…¼å®¹æ€§ä¿è¯
- **ä¿ç•™æ‰€æœ‰ç°æœ‰APIæ¥å£**: ä¸ç ´åç°æœ‰åŠŸèƒ½
- **åŸæœ‰åŠŸèƒ½ä¸å—å½±å“**: æ™ºèƒ½åŠŸèƒ½ä½œä¸ºå¢å¼ºå±‚
- **å¯ç‹¬ç«‹å¼€å…³**: é€šè¿‡é…ç½®å¯ç”¨/ç¦ç”¨æ™ºèƒ½åŠŸèƒ½
- **æ•°æ®ç»“æ„å‘åå…¼å®¹**: æ–°å¢å­—æ®µä¸å½±å“æ—§æ•°æ®

#### æ¸è¿›å¼å¯ç”¨
- **ç¬¬ä¸€é˜¶æ®µ**: ä»…å¯ç”¨æ™ºèƒ½å‚æ•°æå–
- **ç¬¬äºŒé˜¶æ®µ**: å¯ç”¨åå¥½è®°å½•
- **ç¬¬ä¸‰é˜¶æ®µ**: å¯ç”¨æ™ºèƒ½æ¨è
- **ç¬¬å››é˜¶æ®µ**: å¯ç”¨ç½®ä¿¡åº¦æ˜¾ç¤º

---

## ğŸš€ Part 6: å®æ–½é˜¶æ®µè§„åˆ’

### å››é˜¶æ®µæ¸è¿›å¼å®æ–½

#### é˜¶æ®µ1ï¼šNLPå¢å¼ºåŸºç¡€ï¼ˆ1-2å‘¨ï¼‰

**ç›®æ ‡**: æå‡å‚æ•°è¯†åˆ«å‡†ç¡®ç‡

**äº¤ä»˜ç‰©**:
- `SmartParamExtractor`ç±»å®Œæ•´å®ç°
- åŒä¹‰è¯è¯å…¸ï¼ˆæ”¯æŒé¢˜å‹ã€éš¾åº¦ã€æ•°é‡ã€çŸ¥è¯†ç‚¹ï¼‰
- å£è¯­åŒ–æ¨¡å¼è¯†åˆ«ï¼ˆ10+å¸¸è§æ¨¡å¼ï¼‰
- åŸºç¡€ç½®ä¿¡åº¦è®¡ç®—ç®—æ³•
- å•å…ƒæµ‹è¯•ï¼ˆè¦†ç›–ç‡>80%ï¼‰

**éªŒæ”¶æ ‡å‡†**:
- "æ‰€æœ‰é¢˜å‹"ã€"æ¥ç‚¹å•é€‰"ç­‰è¡¨è¾¾æ­£ç¡®è¯†åˆ«
- å‚æ•°æå–å‡†ç¡®ç‡ > 85%
- ç½®ä¿¡åº¦è®¡ç®—åˆç†ï¼ˆä¸äººå·¥åˆ¤æ–­ä¸€è‡´æ€§>90%ï¼‰

**é£é™©è¯„ä¼°**: ä½
- ä¸å½±å“ç°æœ‰åŠŸèƒ½
- å¯ç‹¬ç«‹æµ‹è¯•
- æ˜“äºå›æ»š

---

#### é˜¶æ®µ2ï¼šåå¥½è®°å½•ç³»ç»Ÿï¼ˆ1å‘¨ï¼‰

**ç›®æ ‡**: å»ºç«‹ç”¨æˆ·è¡Œä¸ºæ•°æ®åŸºç¡€

**äº¤ä»˜ç‰©**:
- `UserPreferenceManager`ç±»å®Œæ•´å®ç°
- LocalStorageæ•°æ®ç»“æ„è®¾è®¡
- åå¥½ç»Ÿè®¡å’Œåˆ†æé€»è¾‘
- æ•°æ®å¯¼å‡º/å¯¼å…¥åŠŸèƒ½
- éšç§ä¿æŠ¤æœºåˆ¶

**éªŒæ”¶æ ‡å‡†**:
- æˆåŠŸè®°å½•ç”¨æˆ·æ¯æ¬¡æ“ä½œ
- èƒ½ç”ŸæˆåŸºç¡€åå¥½æŠ¥å‘Š
- æ•°æ®æŒä¹…åŒ–æ­£å¸¸
- ä¸å½±å“ç³»ç»Ÿæ€§èƒ½

**é£é™©è¯„ä¼°**: ä½
- ä»…è®°å½•ä¸å½±å“äº¤äº’
- æ•°æ®å­˜å‚¨åœ¨æœ¬åœ°
- å¯éšæ—¶æ¸…é™¤

---

#### é˜¶æ®µ3ï¼šæ™ºèƒ½æ¨èå¼•æ“ï¼ˆ2å‘¨ï¼‰

**ç›®æ ‡**: åŸºäºåå¥½æä¾›æ™ºèƒ½å»ºè®®

**äº¤ä»˜ç‰©**:
- `SmartRecommendationEngine`ç±»å®Œæ•´å®ç°
- æ¨èç®—æ³•å’Œå‚æ•°åˆå¹¶é€»è¾‘
- å»ºè®®æ ¼å¼åŒ–å’Œå±•ç¤º
- A/Bæµ‹è¯•æ¡†æ¶
- æ¨èæ•ˆæœè¯„ä¼°å·¥å…·

**éªŒæ”¶æ ‡å‡†**:
- èƒ½æ ¹æ®å†å²æ¨èå‚æ•°
- æ¨èå‡†ç¡®ç‡ > 70%
- æ¨èå“åº”æ—¶é—´ < 100ms
- ç”¨æˆ·æ¥å—ç‡ > 60%

**é£é™©è¯„ä¼°**: ä¸­
- éœ€è¦å……åˆ†æµ‹è¯•æ¨èé€»è¾‘
- å¯èƒ½éœ€è¦è°ƒæ•´ç®—æ³•
- éœ€è¦æ”¶é›†ç”¨æˆ·åé¦ˆ

---

#### é˜¶æ®µ4ï¼šç½®ä¿¡åº¦å¯è§†åŒ–ï¼ˆ1å‘¨ï¼‰

**ç›®æ ‡**: é€æ˜åŒ–AIç†è§£è¿‡ç¨‹

**äº¤ä»˜ç‰©**:
- `ConfidenceIndicator`ç»„ä»¶å®Œæ•´å®ç°
- UIå¯è§†åŒ–æ•ˆæœï¼ˆå›¾æ ‡ã€é¢œè‰²ã€åŠ¨ç”»ï¼‰
- äº¤äº’ç¡®è®¤æµç¨‹
- ç”¨æˆ·å¼•å¯¼å’Œå¸®åŠ©æ–‡æ¡£
- å¯è®¿é—®æ€§ä¼˜åŒ–

**éªŒæ”¶æ ‡å‡†**:
- ç½®ä¿¡åº¦æ¸…æ™°å¯è§
- ç”¨æˆ·å¯è½»æ¾ä¿®æ­£ç†è§£åå·®
- UIå“åº”æµç•…ï¼ˆ<50msï¼‰
- é€šè¿‡å¯è®¿é—®æ€§æµ‹è¯•

**é£é™©è¯„ä¼°**: ä½
- çº¯UIå¢å¼º
- ä¸å½±å“æ ¸å¿ƒé€»è¾‘
- æ˜“äºè°ƒæ•´

---

### æ€»ä½“è§„åˆ’

**æ€»å‘¨æœŸ**: 5-6å‘¨

**é‡Œç¨‹ç¢‘**:
- Week 1-2: é˜¶æ®µ1å®Œæˆï¼ŒNLPåŸºç¡€å¯ç”¨
- Week 3: é˜¶æ®µ2å®Œæˆï¼Œåå¥½è®°å½•å¯ç”¨
- Week 4-5: é˜¶æ®µ3å®Œæˆï¼Œæ™ºèƒ½æ¨èä¸Šçº¿
- Week 6: é˜¶æ®µ4å®Œæˆï¼Œç½®ä¿¡åº¦æ˜¾ç¤ºä¼˜åŒ–

**è´¨é‡ä¿è¯**:
- æ¯é˜¶æ®µå®Œæˆåç‹¬ç«‹éªŒæ”¶
- æŒç»­é›†æˆå’Œè‡ªåŠ¨åŒ–æµ‹è¯•
- ç”¨æˆ·åé¦ˆæ”¶é›†å’Œå¿«é€Ÿè¿­ä»£
- æ€§èƒ½ç›‘æ§å’Œä¼˜åŒ–

**å›æ»šç­–ç•¥**:
- æ¯ä¸ªé˜¶æ®µå¯ç‹¬ç«‹å›æ»š
- ä¿ç•™åŠŸèƒ½å¼€å…³ï¼Œå¯éšæ—¶ç¦ç”¨
- æ•°æ®å¤‡ä»½å’Œæ¢å¤æœºåˆ¶

---

## ğŸ“ˆ é¢„æœŸæ•ˆæœ

### ç”¨æˆ·ä½“éªŒæå‡
- **è¾“å…¥æ•ˆç‡**: å‡å°‘50%çš„äº¤äº’è½®æ¬¡
- **ç†è§£å‡†ç¡®ç‡**: ä»60%æå‡åˆ°85%+
- **ç”¨æˆ·æ»¡æ„åº¦**: é¢„æœŸæå‡40%
- **å­¦ä¹ æ›²çº¿**: æ–°ç”¨æˆ·ä¸Šæ‰‹æ—¶é—´å‡å°‘60%

### æŠ€æœ¯æŒ‡æ ‡
- **å‚æ•°è¯†åˆ«å‡†ç¡®ç‡**: >85%
- **æ¨èæ¥å—ç‡**: >60%
- **å“åº”æ—¶é—´**: <200ms
- **ç³»ç»Ÿç¨³å®šæ€§**: 99.9%

### ä¸šåŠ¡ä»·å€¼
- **æé«˜ç”¨æˆ·ç•™å­˜**: æ›´å¥½çš„ä½“éªŒå¸¦æ¥æ›´é«˜çš„ç•™å­˜ç‡
- **é™ä½æ”¯æŒæˆæœ¬**: å‡å°‘å› ç†è§£é”™è¯¯å¯¼è‡´çš„ç”¨æˆ·å’¨è¯¢
- **æ•°æ®ç§¯ç´¯**: ä¸ºåç»­AIä¼˜åŒ–æä¾›æ•°æ®åŸºç¡€
- **å·®å¼‚åŒ–ç«äº‰**: æ™ºèƒ½åŒ–äº¤äº’æˆä¸ºäº§å“äº®ç‚¹

---

## ğŸ¯ åç»­ä¼˜åŒ–æ–¹å‘

### çŸ­æœŸä¼˜åŒ–ï¼ˆ3ä¸ªæœˆå†…ï¼‰
1. **å¤šè½®å¯¹è¯ä¼˜åŒ–**: æ”¯æŒæ›´å¤æ‚çš„ä¸Šä¸‹æ–‡ç†è§£
2. **å¤šæ¨¡æ€è¾“å…¥**: æ”¯æŒè¯­éŸ³è¾“å…¥ã€å›¾ç‰‡è¯†åˆ«
3. **ä¸ªæ€§åŒ–UI**: æ ¹æ®ç”¨æˆ·ä¹ æƒ¯è°ƒæ•´ç•Œé¢å¸ƒå±€
4. **å¿«æ·æŒ‡ä»¤**: æ”¯æŒè‡ªå®šä¹‰å¿«æ·å‘½ä»¤

### ä¸­æœŸä¼˜åŒ–ï¼ˆ6ä¸ªæœˆå†…ï¼‰
1. **æ·±åº¦å­¦ä¹ æ¨¡å‹**: å¼•å…¥æ›´å…ˆè¿›çš„NLPæ¨¡å‹
2. **ååŒè¿‡æ»¤**: åŸºäºç›¸ä¼¼ç”¨æˆ·çš„æ¨è
3. **æ™ºèƒ½çº é”™**: è‡ªåŠ¨è¯†åˆ«å’Œçº æ­£ç”¨æˆ·é”™è¯¯
4. **å¤šè¯­è¨€æ”¯æŒ**: æ”¯æŒè‹±æ–‡ç­‰å…¶ä»–è¯­è¨€

### é•¿æœŸæ„¿æ™¯ï¼ˆ1å¹´å†…ï¼‰
1. **å®Œå…¨è‡ªç„¶å¯¹è¯**: æ¥è¿‘äººç±»å¯¹è¯çš„è‡ªç„¶åº¦
2. **ä¸»åŠ¨å¼æœåŠ¡**: AIä¸»åŠ¨å‘ç°ç”¨æˆ·éœ€æ±‚
3. **è·¨åœºæ™¯å­¦ä¹ **: åœ¨ä¸åŒåŠŸèƒ½é—´å…±äº«ç”¨æˆ·åå¥½
4. **æƒ…æ„Ÿè¯†åˆ«**: ç†è§£ç”¨æˆ·æƒ…ç»ªå¹¶è°ƒæ•´äº¤äº’æ–¹å¼

---

## ğŸ“ é™„å½•

### A. æŠ€æœ¯æ ˆ
- **å‰ç«¯**: Vanilla JavaScript, Tailwind CSS
- **æ•°æ®å­˜å‚¨**: LocalStorage
- **NLP**: è‡ªç ”è½»é‡çº§NLPå¼•æ“
- **æµ‹è¯•**: Jest (å•å…ƒæµ‹è¯•), Cypress (E2Eæµ‹è¯•)

### B. å‚è€ƒèµ„æ–™
- ChatGPTå¼å¯¹è¯æ¨¡å‹é‡æ„æ–‡æ¡£
- ç”Ÿæˆé¢˜ç›®åŠŸèƒ½ä¼˜åŒ–æ–‡æ¡£
- è€ƒè¯•ç³»ç»ŸåŠŸèƒ½æ¸…å•

### C. å›¢é˜Ÿåˆ†å·¥
- **NLPå¼€å‘**: 1äººï¼Œè´Ÿè´£å‚æ•°æå–å’Œç†è§£
- **æ¨èç®—æ³•**: 1äººï¼Œè´Ÿè´£æ¨èå¼•æ“
- **å‰ç«¯å¼€å‘**: 1äººï¼Œè´Ÿè´£UIå’Œäº¤äº’
- **æµ‹è¯•**: 1äººï¼Œè´Ÿè´£è´¨é‡ä¿è¯

### D. é£é™©ç®¡ç†
- **æŠ€æœ¯é£é™©**: ç®—æ³•å‡†ç¡®ç‡ä¸è¾¾æ ‡ â†’ æŒç»­ä¼˜åŒ–å’ŒA/Bæµ‹è¯•
- **ç”¨æˆ·æ¥å—åº¦**: ç”¨æˆ·ä¸ä¹ æƒ¯æ–°äº¤äº’ â†’ æä¾›ä¼ ç»Ÿæ¨¡å¼åˆ‡æ¢
- **æ€§èƒ½é£é™©**: è®¡ç®—è€—æ—¶è¿‡é•¿ â†’ å¼‚æ­¥å¤„ç†å’Œç¼“å­˜ä¼˜åŒ–
- **æ•°æ®éšç§**: ç”¨æˆ·æ•°æ®æ³„éœ² â†’ æœ¬åœ°å­˜å‚¨+åŠ å¯†

---

**è®¾è®¡å®Œæˆæ—¥æœŸ**: 2026-02-02  
**è®¾è®¡å®¡æ ¸**: å¾…å®¡æ ¸  
**å®æ–½å¼€å§‹æ—¥æœŸ**: å¾…å®š
