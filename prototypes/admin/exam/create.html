<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>创建考试 - 考试系统</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            primary: { 50: '#E6F9F0', 100: '#C3F0DB', 500: '#00B96B', 600: '#00A35C' },
            success: { 50: '#E8FFEA', 500: '#00B42A', 600: '#00A35C' },
            warning: { 50: '#FFF7E8', 500: '#FF7D00', 600: '#F57C00' },
            error: { 50: '#FFECE8', 500: '#F53F3F', 600: '#E53935' },
            info: { 50: '#E8F7FF', 500: '#14C9C9', 600: '#00ACC1' },
            gray: { 50: '#F9FAFB', 100: '#F3F4F6', 200: '#E5E7EB', 300: '#D1D5DB', 400: '#9CA3AF', 500: '#6B7280', 600: '#4B5563', 700: '#374151', 800: '#1F2937', 900: '#111827' }
          }
        }
      }
    }
  </script>
  <style>
    /* 步骤指示器样式 */
    .step-item {
      position: relative;
      display: flex;
      align-items: center;
      padding: 16px;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .step-item:hover {
      background: #F9FAFB;
    }

    .step-item.active {
      background: #E6F9F0;
      border-left: 3px solid #00B96B;
    }

    .step-item.completed {
      opacity: 0.7;
    }

    .step-number {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 600;
      font-size: 16px;
      background: #E5E7EB;
      color: #9CA3AF;
      flex-shrink: 0;
    }

    .step-item.active .step-number {
      background: #00B96B;
      color: white;
    }

    .step-item.completed .step-number {
      background: #00B42A;
      color: white;
    }

    .step-content {
      display: none;
    }

    .step-content.active {
      display: block;
      animation: fadeIn 0.3s ease-in;
    }

    @keyframes fadeIn {
      from {
        opacity: 0;
        transform: translateY(10px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    /* 单选按钮样式 */
    .radio-card {
      position: relative;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .radio-card:hover {
      border-color: #00B96B;
      background: #F9FAFB;
    }

    .radio-card input:checked ~ .radio-card-content {
      border-color: #00B96B;
      background: #E6F9F0;
    }

    /* 消息提示 */
    .message-container {
      position: fixed;
      top: 20px;
      right: 20px;
      z-index: 9999;
    }

    .message {
      min-width: 300px;
      padding: 16px 20px;
      margin-bottom: 10px;
      border-radius: 8px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.15);
      display: flex;
      align-items: center;
      animation: slideIn 0.3s ease-out;
    }

    @keyframes slideIn {
      from {
        transform: translateX(100%);
        opacity: 0;
      }
      to {
        transform: translateX(0);
        opacity: 1;
      }
    }
  </style>
</head>
<body class="bg-gray-50">
  <div id="messageContainer" class="message-container"></div>

  <!-- 顶部导航 -->
  <header class="h-16 bg-white border-b border-gray-200 fixed top-0 left-0 right-0 z-50">
    <div class="flex items-center justify-between h-full px-6">
      <div class="flex items-center space-x-4">
        <a href="list.html" class="flex items-center space-x-3">
          <div class="w-8 h-8 bg-primary-500 rounded flex items-center justify-center">
            <i class="fas fa-graduation-cap text-white"></i>
          </div>
          <span class="text-xl font-semibold text-gray-900">考试系统</span>
        </a>
        <nav class="flex items-center space-x-2 text-sm text-gray-600">
          <a href="../dashboard.html" class="hover:text-primary-500">首页</a>
          <i class="fas fa-chevron-right text-xs text-gray-400"></i>
          <a href="list.html" class="hover:text-primary-500">考试管理</a>
          <i class="fas fa-chevron-right text-xs text-gray-400"></i>
          <span class="text-gray-900 font-medium">创建考试</span>
        </nav>
      </div>
      <div class="flex items-center space-x-3">
        <img src="https://via.placeholder.com/32" alt="头像" class="w-8 h-8 rounded-full">
        <span class="text-sm text-gray-700">管理员</span>
      </div>
    </div>
  </header>

  <!-- 主内容区 -->
  <main class="pt-16 min-h-screen">
    <div class="flex h-screen">
      <!-- 左侧步骤导航 -->
      <aside class="w-80 bg-white border-r border-gray-200 flex flex-col">
        <div class="p-6 border-b border-gray-200">
          <h2 class="text-xl font-semibold text-gray-900">创建考试</h2>
          <p class="text-sm text-gray-500 mt-1">按照步骤完成考试配置</p>
        </div>
        <div class="flex-1 overflow-y-auto py-4">
          <!-- 步骤1 -->
          <div class="step-item active" id="stepNav1" onclick="goToStep(1)">
            <div class="step-number">1</div>
            <div class="ml-4">
              <div class="text-sm font-medium text-gray-900">基本信息</div>
              <div class="text-xs text-gray-500 mt-0.5">考试名称、编号和时间</div>
            </div>
          </div>

          <!-- 步骤2 -->
          <div class="step-item" id="stepNav2" onclick="goToStep(2)">
            <div class="step-number">2</div>
            <div class="ml-4">
              <div class="text-sm font-medium text-gray-900">选择试卷</div>
              <div class="text-xs text-gray-500 mt-0.5">选择已有试卷或创建新试卷</div>
            </div>
          </div>

          <!-- 步骤3 -->
          <div class="step-item" id="stepNav3" onclick="goToStep(3)">
            <div class="step-number">3</div>
            <div class="ml-4">
              <div class="text-sm font-medium text-gray-900">考试配置</div>
              <div class="text-xs text-gray-500 mt-0.5">防作弊和成绩公布设置</div>
            </div>
          </div>

          <!-- 步骤4 -->
          <div class="step-item" id="stepNav4" onclick="goToStep(4)">
            <div class="step-number">4</div>
            <div class="ml-4">
              <div class="text-sm font-medium text-gray-900">完成</div>
              <div class="text-xs text-gray-500 mt-0.5">确认信息并创建</div>
            </div>
          </div>
        </div>
      </aside>

      <!-- 右侧内容区 -->
      <div class="flex-1 overflow-y-auto">
        <div class="max-w-4xl mx-auto p-8">

          <!-- 步骤1：基本信息 -->
          <div id="step1" class="step-content active">
            <div class="bg-white rounded-lg shadow-sm border border-gray-200 p-6">
              <h3 class="text-lg font-semibold text-gray-900 mb-6">基本信息</h3>

              <div class="space-y-6">
                <!-- 考试名称 -->
                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-2">
                    考试名称 <span class="text-error-500">*</span>
                  </label>
                  <input type="text" id="examName" placeholder="例如：2026春季期末考试" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500">
                </div>

                <!-- 试卷编号 -->
                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-2">
                    试卷编号 <span class="text-error-500">*</span>
                  </label>
                  <input type="text" id="examCode" value="E004" placeholder="系统自动生成" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500">
                  <p class="mt-1 text-xs text-gray-500">系统已自动生成编号，您也可以手动修改</p>
                </div>

                <!-- 开放时间 -->
                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-2">
                    开放时间 <span class="text-error-500">*</span>
                  </label>
                  <div class="grid grid-cols-2 gap-4">
                    <div>
                      <input type="datetime-local" id="openStartTime" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500">
                      <p class="mt-1 text-xs text-gray-500">开始时间</p>
                    </div>
                    <div>
                      <input type="datetime-local" id="openEndTime" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500">
                      <p class="mt-1 text-xs text-gray-500">结束时间</p>
                    </div>
                  </div>
                </div>

                <!-- 作答时间 -->
                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-2">
                    作答时间（分钟） <span class="text-error-500">*</span>
                  </label>
                  <input type="number" id="examDuration" placeholder="例如：120" min="1" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500">
                  <p class="mt-1 text-xs text-gray-500">考生需在此时间内完成答题并提交</p>
                </div>

                <!-- 作答次数 -->
                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-2">
                    作答次数 <span class="text-error-500">*</span>
                  </label>
                  <div class="flex items-center space-x-4">
                    <label class="flex items-center cursor-pointer">
                      <input type="radio" name="attemptType" value="unlimited" checked class="w-4 h-4 text-primary-500 border-gray-300 focus:ring-primary-500">
                      <span class="ml-2 text-sm text-gray-700">不限次数</span>
                    </label>
                    <label class="flex items-center cursor-pointer">
                      <input type="radio" name="attemptType" value="limited" class="w-4 h-4 text-primary-500 border-gray-300 focus:ring-primary-500" onchange="toggleAttemptLimit()">
                      <span class="ml-2 text-sm text-gray-700">限制次数</span>
                    </label>
                  </div>
                  <div id="attemptLimitInput" class="mt-3 hidden">
                    <input type="number" id="attemptLimit" placeholder="输入次数" min="1" class="w-48 px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500">
                    <span class="ml-2 text-sm text-gray-500">次</span>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- 步骤2：选择试卷 -->
          <div id="step2" class="step-content">
            <div class="bg-white rounded-lg shadow-sm border border-gray-200 p-6">
              <h3 class="text-lg font-semibold text-gray-900 mb-6">选择试卷</h3>

              <div class="space-y-6">
                <!-- 选择方式 -->
                <div class="grid grid-cols-2 gap-4">
                  <!-- 选择已有试卷 -->
                  <label class="radio-card">
                    <input type="radio" name="paperSource" value="existing" checked class="sr-only" onchange="togglePaperSource()">
                    <div class="radio-card-content border-2 border-gray-200 rounded-lg p-4 hover:border-primary-500 transition-colors">
                      <div class="flex items-center justify-between mb-2">
                        <div class="flex items-center">
                          <i class="fas fa-file-alt text-primary-500 text-xl"></i>
                          <span class="ml-3 font-medium text-gray-900">选择已有试卷</span>
                        </div>
                        <i class="fas fa-check-circle text-primary-500"></i>
                      </div>
                      <p class="text-sm text-gray-500">从试卷库中选择已创建的试卷</p>
                    </div>
                  </label>

                  <!-- 创建新试卷 -->
                  <label class="radio-card">
                    <input type="radio" name="paperSource" value="new" class="sr-only" onchange="togglePaperSource()">
                    <div class="radio-card-content border-2 border-gray-200 rounded-lg p-4 hover:border-primary-500 transition-colors">
                      <div class="flex items-center justify-between mb-2">
                        <div class="flex items-center">
                          <i class="fas fa-plus-circle text-info-500 text-xl"></i>
                          <span class="ml-3 font-medium text-gray-900">创建新试卷</span>
                        </div>
                        <i class="fas fa-check-circle text-primary-500 hidden"></i>
                      </div>
                      <p class="text-sm text-gray-500">跳转到试卷创建页面新建试卷</p>
                    </div>
                  </label>
                </div>

                <!-- 选择已有试卷 -->
                <div id="existingPaperSection">
                  <label class="block text-sm font-medium text-gray-700 mb-2">
                    选择试卷 <span class="text-error-500">*</span>
                  </label>
                  <select id="selectedPaper" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500" onchange="showPaperPreview()">
                    <option value="">请选择试卷</option>
                    <option value="P001">P001 - 计算机基础期末卷</option>
                    <option value="P002">P002 - 数学期中测验卷</option>
                    <option value="P003">P003 - 英语听力专项卷</option>
                    <option value="P004">P004 - 物理实验考核卷</option>
                  </select>

                  <!-- 试卷预览 -->
                  <div id="paperPreview" class="hidden mt-4 p-4 bg-gray-50 rounded-lg border border-gray-200">
                    <h4 class="text-sm font-medium text-gray-700 mb-3">试卷预览</h4>
                    <div class="grid grid-cols-3 gap-4 text-sm">
                      <div>
                        <span class="text-gray-500">题目数量：</span>
                        <span class="font-medium text-gray-900" id="previewQuestionCount">-</span>
                      </div>
                      <div>
                        <span class="text-gray-500">总分：</span>
                        <span class="font-medium text-gray-900" id="previewTotalScore">-</span>
                      </div>
                      <div>
                        <span class="text-gray-500">试卷模式：</span>
                        <span class="font-medium text-gray-900" id="previewPaperMode">-</span>
                      </div>
                    </div>
                  </div>
                </div>

                <!-- 创建新试卷提示 -->
                <div id="newPaperSection" class="hidden">
                  <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
                    <div class="flex items-start">
                      <i class="fas fa-info-circle text-blue-500 mt-0.5 mr-3"></i>
                      <div class="flex-1">
                        <p class="text-sm text-blue-700 mb-3">点击下方按钮将跳转到试卷创建页面，创建完成后返回本页面继续。</p>
                        <a href="../paper/list.html" class="inline-flex items-center px-4 py-2 bg-info-500 hover:bg-info-600 text-white rounded-lg text-sm font-medium transition-colors">
                          <i class="fas fa-plus mr-2"></i>前往创建试卷
                        </a>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- 步骤3：考试配置 -->
          <div id="step3" class="step-content">
            <div class="bg-white rounded-lg shadow-sm border border-gray-200 p-6">
              <h3 class="text-lg font-semibold text-gray-900 mb-6">考试配置</h3>

              <div class="space-y-6">
                <!-- 迟到设置 -->
                <div class="border-b border-gray-100 pb-6">
                  <h4 class="text-sm font-medium text-gray-900 mb-4">迟到设置</h4>
                  <div class="space-y-3">
                    <label class="flex items-start cursor-pointer">
                      <input type="checkbox" id="enableLateLimit" class="mt-1 w-4 h-4 text-primary-500 border-gray-300 rounded focus:ring-primary-500" onchange="toggleLateLimit()">
                      <div class="ml-3">
                        <span class="text-sm text-gray-700">开考后禁止迟到进入</span>
                        <div id="lateLimitInput" class="hidden mt-2 flex items-center">
                          <span class="text-sm text-gray-500 mr-2">开考后</span>
                          <input type="number" id="lateMinutes" placeholder="15" min="1" class="w-24 px-3 py-1.5 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-primary-500">
                          <span class="text-sm text-gray-500 ml-2">分钟后禁止进入</span>
                        </div>
                      </div>
                    </label>

                    <label class="flex items-start cursor-pointer">
                      <input type="checkbox" id="enableEarlyEntry" class="mt-1 w-4 h-4 text-primary-500 border-gray-300 rounded focus:ring-primary-500" onchange="toggleEarlyEntry()">
                      <div class="ml-3">
                        <span class="text-sm text-gray-700">允许提前进入考试（不可答题）</span>
                        <div id="earlyEntryInput" class="hidden mt-2 flex items-center">
                          <span class="text-sm text-gray-500 mr-2">提前</span>
                          <input type="number" id="earlyMinutes" placeholder="10" min="1" class="w-24 px-3 py-1.5 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-primary-500">
                          <span class="text-sm text-gray-500 ml-2">分钟可进入</span>
                        </div>
                      </div>
                    </label>
                  </div>
                </div>

                <!-- 防作弊设置 -->
                <div class="border-b border-gray-100 pb-6">
                  <h4 class="text-sm font-medium text-gray-900 mb-4">防作弊设置</h4>
                  <div class="space-y-3">
                    <label class="flex items-center cursor-pointer">
                      <input type="checkbox" id="enableFaceRecognition" class="w-4 h-4 text-primary-500 border-gray-300 rounded focus:ring-primary-500">
                      <span class="ml-3 text-sm text-gray-700">进入考试时开启人脸识别</span>
                    </label>

                    <label class="flex items-start cursor-pointer">
                      <input type="checkbox" id="enableRandomCapture" class="mt-1 w-4 h-4 text-primary-500 border-gray-300 rounded focus:ring-primary-500" onchange="toggleRandomCapture()">
                      <div class="ml-3">
                        <span class="text-sm text-gray-700">考试中随机抓拍</span>
                        <div id="randomCaptureInput" class="hidden mt-2 flex items-center">
                          <span class="text-sm text-gray-500 mr-2">随机抓拍</span>
                          <input type="number" id="captureCount" placeholder="3" min="1" class="w-24 px-3 py-1.5 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-primary-500">
                          <span class="text-sm text-gray-500 ml-2">张照片</span>
                        </div>
                      </div>
                    </label>
                  </div>
                </div>

                <!-- 交卷限制 -->
                <div class="border-b border-gray-100 pb-6">
                  <h4 class="text-sm font-medium text-gray-900 mb-4">交卷限制</h4>
                  <label class="flex items-start cursor-pointer">
                    <input type="checkbox" id="enableMinSubmitTime" class="mt-1 w-4 h-4 text-primary-500 border-gray-300 rounded focus:ring-primary-500" onchange="toggleMinSubmitTime()">
                    <div class="ml-3">
                      <span class="text-sm text-gray-700">开启最短交卷时间限制</span>
                      <div id="minSubmitTimeInput" class="hidden mt-2 flex items-center">
                        <span class="text-sm text-gray-500 mr-2">作答至少</span>
                        <input type="number" id="minSubmitMinutes" placeholder="30" min="1" class="w-24 px-3 py-1.5 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-primary-500">
                        <span class="text-sm text-gray-500 ml-2">分钟后才可交卷</span>
                      </div>
                    </div>
                  </label>
                </div>

                <!-- 成绩公布方式 -->
                <div class="border-b border-gray-100 pb-6">
                  <h4 class="text-sm font-medium text-gray-900 mb-4">成绩公布方式</h4>
                  <div class="space-y-3">
                    <label class="flex items-center cursor-pointer">
                      <input type="radio" name="resultPublishType" value="immediate" checked class="w-4 h-4 text-primary-500 border-gray-300 focus:ring-primary-500" onchange="toggleResultPublish()">
                      <span class="ml-3 text-sm text-gray-700">交卷后立即公布</span>
                    </label>

                    <label class="flex items-start cursor-pointer">
                      <input type="radio" name="resultPublishType" value="delayAfterSubmit" class="mt-1 w-4 h-4 text-primary-500 border-gray-300 focus:ring-primary-500" onchange="toggleResultPublish()">
                      <div class="ml-3">
                        <span class="text-sm text-gray-700">交卷后延迟公布</span>
                        <div id="delayAfterSubmitInput" class="hidden mt-2 flex items-center">
                          <span class="text-sm text-gray-500 mr-2">交卷后</span>
                          <input type="number" id="delayDaysAfterSubmit" placeholder="1" min="1" class="w-24 px-3 py-1.5 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-primary-500">
                          <span class="text-sm text-gray-500 ml-2">天后公布</span>
                        </div>
                      </div>
                    </label>

                    <label class="flex items-center cursor-pointer">
                      <input type="radio" name="resultPublishType" value="afterExamEnd" class="w-4 h-4 text-primary-500 border-gray-300 focus:ring-primary-500" onchange="toggleResultPublish()">
                      <span class="ml-3 text-sm text-gray-700">考试结束后立即公布</span>
                    </label>

                    <label class="flex items-start cursor-pointer">
                      <input type="radio" name="resultPublishType" value="delayAfterExamEnd" class="mt-1 w-4 h-4 text-primary-500 border-gray-300 focus:ring-primary-500" onchange="toggleResultPublish()">
                      <div class="ml-3">
                        <span class="text-sm text-gray-700">考试结束后延迟公布</span>
                        <div id="delayAfterExamEndInput" class="hidden mt-2 flex items-center">
                          <span class="text-sm text-gray-500 mr-2">考试结束后</span>
                          <input type="number" id="delayHoursAfterExamEnd" placeholder="24" min="1" class="w-24 px-3 py-1.5 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-primary-500">
                          <span class="text-sm text-gray-500 ml-2">小时后公布</span>
                        </div>
                      </div>
                    </label>
                  </div>
                </div>

                <!-- 成绩公布内容 -->
                <div class="border-b border-gray-100 pb-6">
                  <h4 class="text-sm font-medium text-gray-900 mb-4">成绩公布内容</h4>
                  <div class="space-y-3">
                    <label class="flex items-center cursor-pointer">
                      <input type="radio" name="resultContent" value="scoreOnly" checked class="w-4 h-4 text-primary-500 border-gray-300 focus:ring-primary-500">
                      <span class="ml-3 text-sm text-gray-700">仅分数</span>
                    </label>

                    <label class="flex items-center cursor-pointer">
                      <input type="radio" name="resultContent" value="scoreAndCorrect" class="w-4 h-4 text-primary-500 border-gray-300 focus:ring-primary-500">
                      <span class="ml-3 text-sm text-gray-700">分数及对错</span>
                    </label>

                    <label class="flex items-center cursor-pointer">
                      <input type="radio" name="resultContent" value="full" class="w-4 h-4 text-primary-500 border-gray-300 focus:ring-primary-500">
                      <span class="ml-3 text-sm text-gray-700">分数、对错、答案及解析</span>
                    </label>
                  </div>
                </div>

                <!-- AI批阅设置 -->
                <div>
                  <h4 class="text-sm font-medium text-gray-900 mb-4">AI批阅设置</h4>
                  <div class="space-y-3">
                    <label class="flex items-center cursor-pointer">
                      <input type="checkbox" id="enableAIGrading" class="w-4 h-4 text-primary-500 border-gray-300 rounded focus:ring-primary-500">
                      <span class="ml-3 text-sm text-gray-700">简答题开启AI批阅</span>
                    </label>

                    <label class="flex items-center cursor-pointer">
                      <input type="checkbox" id="enableAIComment" class="w-4 h-4 text-primary-500 border-gray-300 rounded focus:ring-primary-500">
                      <span class="ml-3 text-sm text-gray-700">生成AI评语</span>
                    </label>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- 步骤4：完成 -->
          <div id="step4" class="step-content">
            <div class="bg-white rounded-lg shadow-sm border border-gray-200 p-6">
              <h3 class="text-lg font-semibold text-gray-900 mb-6">确认信息</h3>

              <div class="space-y-6">
                <!-- 提示信息 -->
                <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
                  <div class="flex items-start">
                    <i class="fas fa-info-circle text-blue-500 mt-0.5 mr-3"></i>
                    <p class="text-sm text-blue-700">请仔细核对以下信息，确认无误后点击"创建考试"按钮</p>
                  </div>
                </div>

                <!-- 基本信息 -->
                <div class="bg-gray-50 rounded-lg p-4">
                  <h4 class="text-sm font-semibold text-gray-900 mb-3">基本信息</h4>
                  <div class="space-y-2 text-sm">
                    <div class="flex">
                      <span class="w-28 text-gray-500">考试名称：</span>
                      <span class="flex-1 text-gray-900 font-medium" id="confirmExamName">-</span>
                    </div>
                    <div class="flex">
                      <span class="w-28 text-gray-500">试卷编号：</span>
                      <span class="flex-1 text-gray-900" id="confirmExamCode">-</span>
                    </div>
                    <div class="flex">
                      <span class="w-28 text-gray-500">开放时间：</span>
                      <div class="flex-1 text-gray-900">
                        <div id="confirmOpenStartTime">-</div>
                        <div class="text-gray-400 text-xs">至</div>
                        <div id="confirmOpenEndTime">-</div>
                      </div>
                    </div>
                    <div class="flex">
                      <span class="w-28 text-gray-500">作答时间：</span>
                      <span class="flex-1 text-gray-900" id="confirmDuration">-</span>
                    </div>
                    <div class="flex">
                      <span class="w-28 text-gray-500">作答次数：</span>
                      <span class="flex-1 text-gray-900" id="confirmAttempt">-</span>
                    </div>
                  </div>
                </div>

                <!-- 试卷信息 -->
                <div class="bg-gray-50 rounded-lg p-4">
                  <h4 class="text-sm font-semibold text-gray-900 mb-3">试卷信息</h4>
                  <div class="space-y-2 text-sm">
                    <div class="flex">
                      <span class="w-28 text-gray-500">选择方式：</span>
                      <span class="flex-1 text-gray-900" id="confirmPaperSource">-</span>
                    </div>
                    <div class="flex">
                      <span class="w-28 text-gray-500">试卷：</span>
                      <span class="flex-1 text-gray-900" id="confirmPaper">-</span>
                    </div>
                  </div>
                </div>

                <!-- 考试配置 -->
                <div class="bg-gray-50 rounded-lg p-4">
                  <h4 class="text-sm font-semibold text-gray-900 mb-3">考试配置</h4>
                  <div class="space-y-2 text-sm">
                    <div class="flex">
                      <span class="w-28 text-gray-500">防作弊：</span>
                      <span class="flex-1 text-gray-900" id="confirmAntiCheat">-</span>
                    </div>
                    <div class="flex">
                      <span class="w-28 text-gray-500">成绩公布：</span>
                      <span class="flex-1 text-gray-900" id="confirmResultPublish">-</span>
                    </div>
                    <div class="flex">
                      <span class="w-28 text-gray-500">公布内容：</span>
                      <span class="flex-1 text-gray-900" id="confirmResultContent">-</span>
                    </div>
                    <div class="flex">
                      <span class="w-28 text-gray-500">AI批阅：</span>
                      <span class="flex-1 text-gray-900" id="confirmAI">-</span>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- 底部按钮 -->
          <div class="mt-6 flex items-center justify-between">
            <button onclick="prevStep()" id="prevBtn" class="px-6 py-2 text-gray-700 hover:bg-gray-100 rounded-lg font-medium transition-colors hidden">
              <i class="fas fa-chevron-left mr-2"></i>上一步
            </button>
            <div class="flex items-center space-x-3 ml-auto">
              <a href="list.html" class="px-6 py-2 text-gray-700 hover:bg-gray-100 rounded-lg font-medium transition-colors">
                取消
              </a>
              <button onclick="nextStep()" id="nextBtn" class="px-6 py-2 bg-primary-500 hover:bg-primary-600 text-white rounded-lg font-medium transition-colors">
                下一步<i class="fas fa-chevron-right ml-2"></i>
              </button>
              <button onclick="createExam()" id="submitBtn" class="hidden px-6 py-2 bg-primary-500 hover:bg-primary-600 text-white rounded-lg font-medium transition-colors">
                <i class="fas fa-check mr-2"></i>创建考试
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </main>

  <script>
    let currentStep = 1;

    // 试卷数据
    const papers = {
      'P001': { name: '计算机基础期末卷', questionCount: 50, totalScore: 100, mode: '文档模式' },
      'P002': { name: '数学期中测验卷', questionCount: 30, totalScore: 100, mode: '固定抽题' },
      'P003': { name: '英语听力专项卷', questionCount: 40, totalScore: 100, mode: '随机抽题' },
      'P004': { name: '物理实验考核卷', questionCount: 25, totalScore: 100, mode: '文档模式' }
    };

    // 页面加载时生成编号
    document.addEventListener('DOMContentLoaded', function() {
      generateExamCode();
    });

    // 生成考试编号
    function generateExamCode() {
      const timestamp = Date.now().toString().slice(-4);
      document.getElementById('examCode').value = 'E' + timestamp;
    }

    // 切换步骤
    function goToStep(step) {
      if (step > currentStep && !validateStep(currentStep)) {
        return;
      }

      currentStep = step;
      updateStepUI();
    }

    function nextStep() {
      if (!validateStep(currentStep)) {
        return;
      }

      if (currentStep === 3) {
        fillConfirmInfo();
      }

      if (currentStep < 4) {
        currentStep++;
        updateStepUI();
      }
    }

    function prevStep() {
      if (currentStep > 1) {
        currentStep--;
        updateStepUI();
      }
    }

    function updateStepUI() {
      // 更新步骤内容显示
      for (let i = 1; i <= 4; i++) {
        document.getElementById('step' + i).classList.remove('active');
        const nav = document.getElementById('stepNav' + i);
        nav.classList.remove('active', 'completed');

        if (i === currentStep) {
          document.getElementById('step' + i).classList.add('active');
          nav.classList.add('active');
        } else if (i < currentStep) {
          nav.classList.add('completed');
        }
      }

      // 更新按钮显示
      document.getElementById('prevBtn').classList.toggle('hidden', currentStep === 1);
      document.getElementById('nextBtn').classList.toggle('hidden', currentStep === 4);
      document.getElementById('submitBtn').classList.toggle('hidden', currentStep !== 4);
    }

    // 验证步骤
    function validateStep(step) {
      if (step === 1) {
        const name = document.getElementById('examName').value.trim();
        const code = document.getElementById('examCode').value.trim();
        const startTime = document.getElementById('openStartTime').value;
        const endTime = document.getElementById('openEndTime').value;
        const duration = document.getElementById('examDuration').value;

        if (!name) {
          showMessage('请输入考试名称', 'error');
          return false;
        }
        if (!code) {
          showMessage('请输入试卷编号', 'error');
          return false;
        }
        if (!startTime || !endTime) {
          showMessage('请选择开放时间', 'error');
          return false;
        }
        if (new Date(startTime) >= new Date(endTime)) {
          showMessage('结束时间必须晚于开始时间', 'error');
          return false;
        }
        if (!duration || duration <= 0) {
          showMessage('请输入有效的作答时间', 'error');
          return false;
        }
      } else if (step === 2) {
        const paperSource = document.querySelector('input[name="paperSource"]:checked').value;
        if (paperSource === 'existing') {
          const paper = document.getElementById('selectedPaper').value;
          if (!paper) {
            showMessage('请选择试卷', 'error');
            return false;
          }
        }
      }
      return true;
    }

    // 填充确认信息
    function fillConfirmInfo() {
      // 基本信息
      document.getElementById('confirmExamName').textContent = document.getElementById('examName').value;
      document.getElementById('confirmExamCode').textContent = document.getElementById('examCode').value;
      document.getElementById('confirmOpenStartTime').textContent = document.getElementById('openStartTime').value.replace('T', ' ');
      document.getElementById('confirmOpenEndTime').textContent = document.getElementById('openEndTime').value.replace('T', ' ');
      document.getElementById('confirmDuration').textContent = document.getElementById('examDuration').value + ' 分钟';

      const attemptType = document.querySelector('input[name="attemptType"]:checked').value;
      if (attemptType === 'unlimited') {
        document.getElementById('confirmAttempt').textContent = '不限次数';
      } else {
        const limit = document.getElementById('attemptLimit').value;
        document.getElementById('confirmAttempt').textContent = limit + ' 次';
      }

      // 试卷信息
      const paperSource = document.querySelector('input[name="paperSource"]:checked').value;
      document.getElementById('confirmPaperSource').textContent = paperSource === 'existing' ? '选择已有试卷' : '创建新试卷';

      if (paperSource === 'existing') {
        const paperId = document.getElementById('selectedPaper').value;
        const paper = papers[paperId];
        document.getElementById('confirmPaper').textContent = paperId + ' - ' + paper.name;
      } else {
        document.getElementById('confirmPaper').textContent = '待创建';
      }

      // 考试配置
      const antiCheatSettings = [];
      if (document.getElementById('enableFaceRecognition').checked) {
        antiCheatSettings.push('人脸识别');
      }
      if (document.getElementById('enableRandomCapture').checked) {
        const count = document.getElementById('captureCount').value;
        antiCheatSettings.push('随机抓拍' + count + '张');
      }
      document.getElementById('confirmAntiCheat').textContent = antiCheatSettings.length > 0 ? antiCheatSettings.join('、') : '未启用';

      const resultType = document.querySelector('input[name="resultPublishType"]:checked').value;
      const resultTypeMap = {
        'immediate': '交卷后立即公布',
        'delayAfterSubmit': '交卷后' + document.getElementById('delayDaysAfterSubmit').value + '天公布',
        'afterExamEnd': '考试结束后立即公布',
        'delayAfterExamEnd': '考试结束后' + document.getElementById('delayHoursAfterExamEnd').value + '小时公布'
      };
      document.getElementById('confirmResultPublish').textContent = resultTypeMap[resultType];

      const resultContent = document.querySelector('input[name="resultContent"]:checked').value;
      const resultContentMap = {
        'scoreOnly': '仅分数',
        'scoreAndCorrect': '分数及对错',
        'full': '分数、对错、答案及解析'
      };
      document.getElementById('confirmResultContent').textContent = resultContentMap[resultContent];

      const aiSettings = [];
      if (document.getElementById('enableAIGrading').checked) {
        aiSettings.push('AI批阅');
      }
      if (document.getElementById('enableAIComment').checked) {
        aiSettings.push('AI评语');
      }
      document.getElementById('confirmAI').textContent = aiSettings.length > 0 ? aiSettings.join('、') : '未启用';
    }

    // 创建考试
    function createExam() {
      showMessage('创建考试成功！', 'success');
      setTimeout(() => {
        window.location.href = 'list.html';
      }, 1500);
    }

    // 切换作答次数限制
    function toggleAttemptLimit() {
      const isLimited = document.querySelector('input[name="attemptType"]:checked').value === 'limited';
      document.getElementById('attemptLimitInput').classList.toggle('hidden', !isLimited);
    }

    // 切换试卷来源
    function togglePaperSource() {
      const source = document.querySelector('input[name="paperSource"]:checked').value;
      document.getElementById('existingPaperSection').classList.toggle('hidden', source === 'new');
      document.getElementById('newPaperSection').classList.toggle('hidden', source === 'existing');
    }

    // 显示试卷预览
    function showPaperPreview() {
      const paperId = document.getElementById('selectedPaper').value;
      if (paperId) {
        const paper = papers[paperId];
        document.getElementById('paperPreview').classList.remove('hidden');
        document.getElementById('previewQuestionCount').textContent = paper.questionCount + ' 题';
        document.getElementById('previewTotalScore').textContent = paper.totalScore + ' 分';
        document.getElementById('previewPaperMode').textContent = paper.mode;
      } else {
        document.getElementById('paperPreview').classList.add('hidden');
      }
    }

    // 切换迟到限制
    function toggleLateLimit() {
      const enabled = document.getElementById('enableLateLimit').checked;
      document.getElementById('lateLimitInput').classList.toggle('hidden', !enabled);
    }

    // 切换提前进入
    function toggleEarlyEntry() {
      const enabled = document.getElementById('enableEarlyEntry').checked;
      document.getElementById('earlyEntryInput').classList.toggle('hidden', !enabled);
    }

    // 切换随机抓拍
    function toggleRandomCapture() {
      const enabled = document.getElementById('enableRandomCapture').checked;
      document.getElementById('randomCaptureInput').classList.toggle('hidden', !enabled);
    }

    // 切换最短交卷时间
    function toggleMinSubmitTime() {
      const enabled = document.getElementById('enableMinSubmitTime').checked;
      document.getElementById('minSubmitTimeInput').classList.toggle('hidden', !enabled);
    }

    // 切换成绩公布方式
    function toggleResultPublish() {
      const type = document.querySelector('input[name="resultPublishType"]:checked').value;
      document.getElementById('delayAfterSubmitInput').classList.toggle('hidden', type !== 'delayAfterSubmit');
      document.getElementById('delayAfterExamEndInput').classList.toggle('hidden', type !== 'delayAfterExamEnd');
    }

    // 消息提示
    function showMessage(text, type = 'info') {
      const container = document.getElementById('messageContainer');
      const colors = {
        success: 'bg-success-50 text-success-700 border-success-200',
        error: 'bg-error-50 text-error-700 border-error-200',
        warning: 'bg-warning-50 text-warning-700 border-warning-200',
        info: 'bg-info-50 text-info-700 border-info-200'
      };
      const icons = {
        success: 'fa-check-circle',
        error: 'fa-times-circle',
        warning: 'fa-exclamation-circle',
        info: 'fa-info-circle'
      };

      const messageEl = document.createElement('div');
      messageEl.className = `message ${colors[type]} border`;
      messageEl.innerHTML = `
        <i class="fas ${icons[type]} mr-2"></i>
        <span>${text}</span>
      `;

      container.appendChild(messageEl);

      setTimeout(() => {
        messageEl.style.opacity = '0';
        messageEl.style.transform = 'translateX(100%)';
        setTimeout(() => messageEl.remove(), 300);
      }, 3000);
    }
  </script>
</body>
</html>
