<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>简便录入 - 题库管理</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            primary: { 50: '#E6F9F0', 500: '#00B96B', 600: '#00A35C' },
            success: { 50: '#E8FFEA', 500: '#00B42A' },
            warning: { 50: '#FFF7E8', 500: '#FF7D00' },
            error: { 50: '#FFECE8', 500: '#F53F3F' },
            info: { 50: '#E8F7FF', 500: '#14C9C9' }
          }
        }
      }
    }
  </script>
</head>
<body class="bg-gray-50">
  <!-- 顶部导航 -->
  <header class="h-16 bg-white border-b border-gray-200 fixed top-0 left-0 right-0 z-50">
    <div class="flex items-center justify-between h-full px-6 max-w-full mx-auto">
      <div class="flex items-center space-x-4">
        <button onclick="history.back()" class="w-8 h-8 flex items-center justify-center text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded">
          <i class="fas fa-arrow-left"></i>
        </button>
        <div>
          <h1 class="text-lg font-semibold text-gray-900">简便录入</h1>
          <p class="text-xs text-gray-500">按照格式粘贴文本，系统自动解析</p>
        </div>
      </div>
      <div class="flex items-center space-x-3">
        <button onclick="showFormatGuide()" class="bg-white hover:bg-gray-50 text-gray-700 border border-gray-300 px-4 py-2 rounded font-medium text-sm">
          <i class="fas fa-question-circle mr-2"></i>格式说明
        </button>
        <button onclick="parseText()" class="bg-primary-500 hover:bg-primary-600 text-white px-4 py-2 rounded font-medium text-sm">
          <i class="fas fa-check mr-2"></i>解析题目
        </button>
      </div>
    </div>
  </header>

  <div class="pt-16 flex" style="height: 100vh;">
    <!-- 左侧输入区 -->
    <div class="flex-1 border-r border-gray-200 flex flex-col bg-white">
      <!-- 工具栏 -->
      <div class="px-6 py-4 border-b border-gray-200 bg-gray-50">
        <div class="flex items-center justify-between">
          <div class="flex items-center space-x-4">
            <button onclick="clearInput()" class="text-sm text-gray-600 hover:text-gray-900">
              <i class="fas fa-trash mr-1"></i>清空
            </button>
            <button onclick="pasteExample()" class="text-sm text-gray-600 hover:text-gray-900">
              <i class="fas fa-file-import mr-1"></i>粘贴示例
            </button>
            <div class="h-4 w-px bg-gray-300"></div>
            <span class="text-xs text-gray-500">
              <i class="fas fa-info-circle mr-1"></i>支持一次粘贴多道题目
            </span>
          </div>
          <div class="flex items-center space-x-2">
            <span class="text-xs text-gray-500">字符数: <span id="charCount" class="font-medium text-gray-900">0</span></span>
          </div>
        </div>
      </div>

      <!-- 文本输入区 -->
      <div class="flex-1 overflow-y-auto p-6">
        <textarea
          id="inputText"
          class="w-full h-full p-4 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500 font-mono text-sm resize-none"
          placeholder="请粘贴题目文本...&#10;&#10;示例格式：&#10;1. 李白是哪个朝代的？&#10;A. 唐&#10;B. 宋&#10;C. 元&#10;D. 明&#10;答案：A&#10;答案解析：历史问题&#10;知识点：yunti001&#10;&#10;2. 下一道题目..."
          oninput="updateCharCount()"></textarea>
      </div>
    </div>

    <!-- 右侧预览区 -->
    <div class="w-2/5 flex flex-col bg-gray-50">
      <!-- 预览头部 -->
      <div class="px-6 py-4 border-b border-gray-200 bg-white">
        <div class="flex items-center justify-between">
          <div>
            <h3 class="text-base font-semibold text-gray-900">预览与检查</h3>
            <p class="text-xs text-gray-500 mt-1">解析后的题目将显示在此区域</p>
          </div>
          <span id="questionCount" class="text-sm text-gray-600">解析题目: <span class="font-medium text-primary-500">0</span> 道</span>
        </div>
      </div>

      <!-- 统一设置区 -->
      <div class="px-6 py-4 border-b border-gray-200 bg-white" id="batchSettings" style="display: none;">
        <h4 class="text-sm font-medium text-gray-900 mb-3">统一设置</h4>
        <div class="space-y-3">
          <div>
            <label class="block text-xs font-medium text-gray-700 mb-1">知识点</label>
            <select class="w-full px-3 py-2 border border-gray-300 rounded text-sm focus:outline-none focus:ring-2 focus:ring-primary-500">
              <option>选择知识点...</option>
              <option>计算机基础 / 操作系统</option>
              <option>计算机基础 / 网络原理</option>
              <option>数学 / 代数</option>
            </select>
          </div>
          <div>
            <label class="block text-xs font-medium text-gray-700 mb-1">难度</label>
            <select class="w-full px-3 py-2 border border-gray-300 rounded text-sm focus:outline-none focus:ring-2 focus:ring-primary-500">
              <option>简单</option>
              <option>中等</option>
              <option>困难</option>
            </select>
          </div>
        </div>
      </div>

      <!-- 预览内容区 -->
      <div class="flex-1 overflow-y-auto p-6">
        <div id="previewArea">
          <!-- 初始提示 -->
          <div class="text-center py-12">
            <i class="fas fa-file-alt text-4xl text-gray-300 mb-4"></i>
            <p class="text-sm text-gray-500">请在左侧输入区粘贴题目文本</p>
            <p class="text-xs text-gray-400 mt-2">点击"解析题目"按钮进行解析</p>
          </div>
        </div>
      </div>

      <!-- 底部操作栏 -->
      <div class="px-6 py-4 border-t border-gray-200 bg-white" id="actionBar" style="display: none;">
        <div class="flex items-center justify-between">
          <div class="text-sm text-gray-600">
            <i class="fas fa-check-circle text-success-500 mr-1"></i>
            <span id="validCount">0</span> 道有效，
            <i class="fas fa-exclamation-circle text-error-500 mr-1"></i>
            <span id="errorCount">0</span> 道错误
          </div>
          <div class="flex items-center space-x-3">
            <button onclick="cancelParse()" class="bg-white hover:bg-gray-50 text-gray-700 border border-gray-300 px-4 py-2 rounded font-medium text-sm">
              取消
            </button>
            <button onclick="saveQuestions()" class="bg-primary-500 hover:bg-primary-600 text-white px-4 py-2 rounded font-medium text-sm">
              全部录入
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- 格式说明弹窗 -->
  <div id="formatGuideModal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden flex items-center justify-center">
    <div class="bg-white rounded-lg shadow-xl max-w-4xl max-h-[90vh] overflow-hidden">
      <div class="px-6 py-4 border-b border-gray-200 flex items-center justify-between">
        <h3 class="text-lg font-semibold text-gray-900">简便录入格式说明</h3>
        <button onclick="closeFormatGuide()" class="text-gray-400 hover:text-gray-600">
          <i class="fas fa-times"></i>
        </button>
      </div>
      <div class="px-6 py-4 overflow-y-auto" style="max-height: calc(90vh - 120px);">
        <!-- 基础规则 -->
        <div class="mb-6">
          <h4 class="text-base font-semibold text-gray-900 mb-3">基础规则</h4>
          <div class="bg-gray-50 rounded-lg p-4">
            <table class="w-full text-sm">
              <thead>
                <tr class="border-b border-gray-200">
                  <th class="text-left py-2 text-gray-700 font-medium">规则项</th>
                  <th class="text-left py-2 text-gray-700 font-medium">说明</th>
                </tr>
              </thead>
              <tbody class="text-gray-600">
                <tr class="border-b border-gray-200">
                  <td class="py-2">题目标号</td>
                  <td class="py-2">支持 <code class="px-1 bg-white rounded">1.</code> <code class="px-1 bg-white rounded">1、</code> <code class="px-1 bg-white rounded">1:</code> <code class="px-1 bg-white rounded">1。</code> 四种格式</td>
                </tr>
                <tr class="border-b border-gray-200">
                  <td class="py-2">答案字段</td>
                  <td class="py-2">客观题必须含有 <code class="px-1 bg-white rounded">答案：</code> 或 <code class="px-1 bg-white rounded">答：</code></td>
                </tr>
                <tr class="border-b border-gray-200">
                  <td class="py-2">解析字段</td>
                  <td class="py-2"><code class="px-1 bg-white rounded">答案解析：</code> 非必需</td>
                </tr>
                <tr class="border-b border-gray-200">
                  <td class="py-2">知识点字段</td>
                  <td class="py-2">必填，格式为 <code class="px-1 bg-white rounded">知识点：知识点编号</code></td>
                </tr>
                <tr>
                  <td class="py-2">选项分隔符</td>
                  <td class="py-2">字母和选项内容用 <code class="px-1 bg-white rounded">(</code> <code class="px-1 bg-white rounded">.</code> <code class="px-1 bg-white rounded">：</code> <code class="px-1 bg-white rounded">。</code> <code class="px-1 bg-white rounded">:</code> 隔开</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>

        <!-- 题型特殊规则 -->
        <div class="mb-6">
          <h4 class="text-base font-semibold text-gray-900 mb-3">题型特殊规则</h4>
          <div class="space-y-4">
            <div class="bg-info-50 rounded-lg p-4">
              <p class="text-sm font-medium text-info-900 mb-2"><i class="fas fa-circle-dot mr-2"></i>判断题</p>
              <p class="text-sm text-info-700">选项支持：正确/错误、对/错、真/假、是/否、T/F、√/×</p>
            </div>
            <div class="bg-warning-50 rounded-lg p-4">
              <p class="text-sm font-medium text-warning-900 mb-2"><i class="fas fa-pen mr-2"></i>填空题</p>
              <p class="text-sm text-warning-700">空位用 <code class="px-1 bg-white rounded">____</code>（四个及以上下划线）或 <code class="px-1 bg-white rounded">（）</code> 标识</p>
              <p class="text-sm text-warning-700 mt-1">多空答案用 <code class="px-1 bg-white rounded">，</code> <code class="px-1 bg-white rounded">、</code> 隔开；同义词用 <code class="px-1 bg-white rounded">|||</code> 连接</p>
            </div>
            <div class="bg-success-50 rounded-lg p-4">
              <p class="text-sm font-medium text-success-900 mb-2"><i class="fas fa-list mr-2"></i>复合题子题</p>
              <p class="text-sm text-success-700">格式为 <code class="px-1 bg-white rounded">1）【题型】题干内容</code></p>
            </div>
          </div>
        </div>

        <!-- 示例 -->
        <div class="mb-4">
          <h4 class="text-base font-semibold text-gray-900 mb-3">输入示例</h4>
          <div class="bg-gray-900 rounded-lg p-4 text-gray-100 font-mono text-xs overflow-x-auto">
            <pre>1. 李白是哪个朝代的？
A. 唐
B. 宋
C. 元
D. 明
答案：A
答案解析：历史问题
知识点：yunti001

2. 明清是中国小说史上的繁荣时期。以下作品属于明清时期四大名著的有?
A. 红楼梦
B. 三国演义
C. 窦娥冤
D. 西厢记
答案：AB
知识点：yunti001，yunti002</pre>
          </div>
        </div>
      </div>
      <div class="px-6 py-4 border-t border-gray-200 flex justify-end">
        <button onclick="closeFormatGuide()" class="bg-primary-500 hover:bg-primary-600 text-white px-6 py-2 rounded font-medium text-sm">
          我知道了
        </button>
      </div>
    </div>
  </div>

  <script>
    function updateCharCount() {
      const input = document.getElementById('inputText');
      document.getElementById('charCount').textContent = input.value.length;
    }

    function clearInput() {
      if (confirm('确定要清空输入内容吗？')) {
        document.getElementById('inputText').value = '';
        updateCharCount();
      }
    }

    function pasteExample() {
      const example = `1. 李白是哪个朝代的？
A. 唐
B. 宋
C. 元
D. 明
答案：A
答案解析：历史问题
知识点：yunti001

2. 明清是中国小说史上的繁荣时期。以下作品属于明清时期四大名著的有?
A. 红楼梦
B. 三国演义
C. 窦娥冤
D. 西厢记
答案：AB
知识点：yunti001，yunti002

3. 扩散现象说明物质的分子在永不停息地做无规则运动
答案：正确
知识点：yunti003`;

      document.getElementById('inputText').value = example;
      updateCharCount();
    }

    function parseText() {
      const input = document.getElementById('inputText').value;
      if (!input.trim()) {
        alert('请先输入题目文本');
        return;
      }

      // 模拟解析过程
      document.getElementById('batchSettings').style.display = 'block';
      document.getElementById('actionBar').style.display = 'flex';

      // 模拟解析结果
      const previewHtml = `
        <!-- 成功解析的题目1 -->
        <div class="bg-white rounded-lg border border-gray-200 shadow-sm p-4 mb-4">
          <div class="flex items-start justify-between mb-3">
            <div class="flex items-center space-x-2">
              <span class="bg-success-50 text-success-600 px-2 py-0.5 rounded text-xs font-medium">单选题</span>
              <span class="text-sm text-gray-600">题目 #1</span>
            </div>
            <i class="fas fa-check-circle text-success-500"></i>
          </div>
          <p class="text-sm text-gray-900 mb-3">李白是哪个朝代的？</p>
          <div class="space-y-1 mb-3">
            <div class="flex items-center space-x-2 text-xs">
              <span class="w-6 text-gray-600">A.</span>
              <span class="text-gray-900">唐</span>
              <i class="fas fa-check text-success-500 ml-2"></i>
            </div>
            <div class="flex items-center space-x-2 text-xs">
              <span class="w-6 text-gray-600">B.</span>
              <span class="text-gray-900">宋</span>
            </div>
            <div class="flex items-center space-x-2 text-xs">
              <span class="w-6 text-gray-600">C.</span>
              <span class="text-gray-900">元</span>
            </div>
            <div class="flex items-center space-x-2 text-xs">
              <span class="w-6 text-gray-600">D.</span>
              <span class="text-gray-900">明</span>
            </div>
          </div>
          <div class="text-xs text-gray-600 space-y-1">
            <p><span class="font-medium">知识点：</span>yunti001</p>
            <p><span class="font-medium">解析：</span>历史问题</p>
          </div>
        </div>

        <!-- 成功解析的题目2 -->
        <div class="bg-white rounded-lg border border-gray-200 shadow-sm p-4 mb-4">
          <div class="flex items-start justify-between mb-3">
            <div class="flex items-center space-x-2">
              <span class="bg-primary-50 text-primary-600 px-2 py-0.5 rounded text-xs font-medium">多选题</span>
              <span class="text-sm text-gray-600">题目 #2</span>
            </div>
            <i class="fas fa-check-circle text-success-500"></i>
          </div>
          <p class="text-sm text-gray-900 mb-3">明清是中国小说史上的繁荣时期。以下作品属于明清时期四大名著的有?</p>
          <div class="space-y-1 mb-3">
            <div class="flex items-center space-x-2 text-xs">
              <span class="w-6 text-gray-600">A.</span>
              <span class="text-gray-900">红楼梦</span>
              <i class="fas fa-check text-success-500 ml-2"></i>
            </div>
            <div class="flex items-center space-x-2 text-xs">
              <span class="w-6 text-gray-600">B.</span>
              <span class="text-gray-900">三国演义</span>
              <i class="fas fa-check text-success-500 ml-2"></i>
            </div>
            <div class="flex items-center space-x-2 text-xs">
              <span class="w-6 text-gray-600">C.</span>
              <span class="text-gray-900">窦娥冤</span>
            </div>
            <div class="flex items-center space-x-2 text-xs">
              <span class="w-6 text-gray-600">D.</span>
              <span class="text-gray-900">西厢记</span>
            </div>
          </div>
          <div class="text-xs text-gray-600">
            <p><span class="font-medium">知识点：</span>yunti001，yunti002</p>
          </div>
        </div>

        <!-- 成功解析的题目3 -->
        <div class="bg-white rounded-lg border border-gray-200 shadow-sm p-4 mb-4">
          <div class="flex items-start justify-between mb-3">
            <div class="flex items-center space-x-2">
              <span class="bg-info-50 text-info-600 px-2 py-0.5 rounded text-xs font-medium">判断题</span>
              <span class="text-sm text-gray-600">题目 #3</span>
            </div>
            <i class="fas fa-check-circle text-success-500"></i>
          </div>
          <p class="text-sm text-gray-900 mb-3">扩散现象说明物质的分子在永不停息地做无规则运动</p>
          <div class="space-y-1 mb-3">
            <div class="flex items-center space-x-2 text-xs">
              <span class="text-gray-900">正确</span>
              <i class="fas fa-check text-success-500 ml-2"></i>
            </div>
          </div>
          <div class="text-xs text-gray-600">
            <p><span class="font-medium">知识点：</span>yunti003</p>
          </div>
        </div>
      `;

      document.getElementById('previewArea').innerHTML = previewHtml;
      document.getElementById('questionCount').innerHTML = '解析题目: <span class="font-medium text-primary-500">3</span> 道';
      document.getElementById('validCount').textContent = '3';
      document.getElementById('errorCount').textContent = '0';
    }

    function cancelParse() {
      document.getElementById('batchSettings').style.display = 'none';
      document.getElementById('actionBar').style.display = 'none';
      document.getElementById('previewArea').innerHTML = `
        <div class="text-center py-12">
          <i class="fas fa-file-alt text-4xl text-gray-300 mb-4"></i>
          <p class="text-sm text-gray-500">请在左侧输入区粘贴题目文本</p>
          <p class="text-xs text-gray-400 mt-2">点击"解析题目"按钮进行解析</p>
        </div>
      `;
      document.getElementById('questionCount').innerHTML = '解析题目: <span class="font-medium text-primary-500">0</span> 道';
    }

    function saveQuestions() {
      if (confirm('确定要录入这 3 道题目吗？')) {
        alert('题目录入成功！');
        window.location.href = 'list.html';
      }
    }

    function showFormatGuide() {
      document.getElementById('formatGuideModal').classList.remove('hidden');
    }

    function closeFormatGuide() {
      document.getElementById('formatGuideModal').classList.add('hidden');
    }
  </script>
  <!-- iframe嵌入检测脚本 -->
  <script>
  (function() {
    function isInIframe() {
      try {
        return window.self !== window.top;
      } catch (e) {
        return true;
      }
    }
    function hasEmbeddedParam() {
      return window.location.search.includes("embedded=true");
    }
    if (isInIframe() || hasEmbeddedParam()) {
      const style = document.createElement("style");
      style.textContent = `
        header { display: none !important; }
        .pt-16 { padding-top: 0 !important; }
        button[onclick*="history.back"] { display: none !important; }
      `;
      document.head.appendChild(style);
      if (document.readyState === "loading") {
        document.addEventListener("DOMContentLoaded", hideElements);
      } else {
        hideElements();
      }
      function hideElements() {
        const headers = document.querySelectorAll("header");
        headers.forEach(h => h.style.display = "none");
        const ptElements = document.querySelectorAll(".pt-16");
        ptElements.forEach(el => {
          el.classList.remove("pt-16");
          el.style.paddingTop = "0";
        });
        const backButtons = document.querySelectorAll("button[onclick*="history.back"]");
        backButtons.forEach(btn => btn.style.display = "none");
      }
    }
  })();
  </script>

</body>
</html>
